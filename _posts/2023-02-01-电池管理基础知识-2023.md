---
layout:     post
title:      "电池管理基础知识, 2023"
subtitle:   "电源"
date:       2023-02-01 17:35:00
author:     "Ruer"
header-img: "img/bg/hello_world.jpg"
catalog: true
tags:
    - 硬件
---

## 应用场景

#### 锂电池

![1](/img/Hardware/锂电池.jpg)

* 目前在电子设备上使用最广泛的可充电电池。
* 能量密度大、平均输出电压高、自放电小。
* 没有记忆效应、工作温度范围宽、循环性能优越。
* 可快速充放电、充电效率高。
* 输出功率大、使用寿命长。
* 不含有毒有害物质。

#### 电源管理

![2](/img/Hardware/电源管理.jpg)

* 提供多个不同电压的电源。
* 负责为内部电池充电。
* 报告电池的电量以及充电状态。
* 提供电池的健康状态和电池的满充容量。

## 电池特性

#### 化学容量 Qmax

在便携式应用中，有关电池功能性的主要问题是“它能持续工作多长的时间”？

这是由活性材料的数量、容量和电压特性决定的。当电池放电时，其电压逐步下降，直至达到设备可接受的最小电压（被称为“放电终止电压 [EDV]”）为止，也就是如果在该电压下继续放电将导致电池受损。通过对放电过程中的传递电荷进行积分，我们可以测量在达到 EDV 之前可以放电的容量 Qmax。

这个容量的值是和负载没有关系的。它是指在极小的负载电流情况下，电池能够放出了的容量，通常它的单位是用 mAh 来表示的。

![3](/img/Hardware/化学容量.png)

#### 可用容量 Quse

电池的化学容量是在电流很小的时候测得的容量，它更多的是由电池本身的特性决定的。

由于存在电池的内阻，实际的放电曲线是蓝色的这条曲线，由蓝色的曲线和红色的曲线对应的值得到 Quse，Quse 实际指的是电池的可用容量。

从这个曲线中我们也可以看出，电流越大，Quse 会越小.。在这曲线当中，I*Rbat 就是指的由于内阻的存在，造成电池端电压的下降。

![4](/img/Hardware/可用容量.png)

#### 剩余容量 RM

RM 是指当前状态放到 EDV 的电池容量，EDV 也就是终止放电电压。RM 的大小取决于负载的，负载越大，在同一个状态下剩余容量就越小。

电池的剩余容量是与放电速率有关的，不同的电流下面电池的剩余容量是不一样的。当我们看到电池容量由少变多的情况，这个通常是由于放电电流突然变小造成，它可以放出的容量是可以增加的。

![5](/img/Hardware/剩余容量.jpg)

#### 电荷状态 SOC

SOC 是 State Of Charge 的缩写，实际是指的容量百分比，也就是大家经常在使用手机或者平板电脑的时候屏幕角上的容量百分比。

#### 放电深度 DOD

DOD 是 Depth Of Discharge 的缩写，DOD 实际上和 SOC 是一个相对的概念，表示电池从满充状态到现在已经放了多少电。

![6](/img/Hardware/电荷状态与放电深度.png)

#### 电池内阻 Rbat

电池的内阻对电池电压的监测是有很重要的影响的。基本的公式可以用这样一个公式来表示电池的内阻对电池电量监测的影响：

`V = Vocv - I*Rbat`

这个公式里面 Vocv 指的是电池的开路电压，I 是指充放电电流，Rbat 是指的电池的内阻，V 是指电池的端电压。

电池的阻抗实际是受很多因数影响的，受到环境温度、电池的容量百分比、电池的老化程度的影响。电池的内阻通常在100次充放电之后会增加1倍，这是一个经验值。同一批电池之间的偏差控制得比较好的大概可以控制在10~15%左右，不同电池的制造商生产的电池内阻的偏差往往会更大。

![7](/img/Hardware/电池内阻1.png)
![8](/img/Hardware/电池内阻2.png)

## 监测电路

#### 电池包侧电量监测

电量监测计位于电池包侧，以连续监测电池工作情况并通过 I2C 或单线协议将剩余容量或运行时间信息提供给主机。

然而，当电池循环寿命终止时，即使电量监测计仍然处于良好状态我们也不得不扔掉电池包，增加了最终用户的成本。

![9](/img/Hardware/电池包侧电量监测.png)

#### 系统测电量监测

电量监测计位于主机侧以尽量降低电池包成本。当电池包使用寿命结束时，就不必购买电池包中的另一套电子组件。

![10](/img/Hardware/系统侧电量监测.png)

## 电量计算

#### 基于电压的电量监测

基本思路是对不同电压用不同的格数来表示电池的容量，这种方法精度比较差，通常用在低端得最早期出现的那些蜂窝电话，或者早期出现的数码相机里面。

误差比较大的原因就是因为电池存在内阻，在电流变化比较大的情况下，它的格数跳变会比较多。

![11](/img/Hardware/基于电压的电量监测.png)

#### 基于库伦计数的电量监测

电量监测计的思路就是，首先把一个电池充到满，充满过程中就能够知道电池的现有容量，就是电池的满充容量，然后在放电过程当中把电池的放电容量从现有容量中扣去就可以得到现在电池里面还剩多少容量。电池出厂以前都要做一个充放电周期循环来得到电池的满充容量。

此外电池内部的充放电，电池内部耗掉的电流它是测不到的，所以这个结果也不是很准确，使用年限延迟之后也会造成误差的增加。

![12](/img/Hardware/基于库伦计数的电量监测.png)

## 常见问题

#### ADC 超量程

ADC 普遍量程都不高，通常不直接测电池电压。使用分压电阻将电压变小，测到电压后再按比例换算成实际电压。

![13](/img/Hardware/ADC超量程.png)

#### 高低温充电

电池厂商一般都会注明高低温下，充电速度有限制。因此需要根据使用时电池的温度，动态调整充电电流的大小。

一般电池包里面还会放一个热敏电阻，用来监测电池包的温度，可以通过这个来获取电池的温度。

![14](/img/Hardware/高低温充电.png)

#### 不同负载电池电压的差异

由于电池的内存，导致连接负载的时候，电池的端电压会有一定压降。当负载越大的时候，压降会越明显。所以应该在系统负载稳定的时候采集电压，避免在瞬时电流大的时候去获取，比如说发送无线数据射频工作的瞬间。

![15](/img/Hardware/不同负载电池电压的差异.png)

#### 相同负载电压不同电流也不同

相同负载下测算功耗，随着放电过程电压也会下降，因为负载不变所以电流会同步上升。所以比较功耗的时候需要在相同电压下，避免数据结论出现偏差。

#### 避免电池过放

电池若是在放电过程中，超过电池放电的终止电压值，还继续放电时就可能会造成电池内压升高，正、负极活性物质的可逆性遭到损坏，使电池的容量产生明显减少。

#### 恒流充电和恒压充电

常见的电源管理芯片，电池充电的初期会先进行恒流充电，电流大小是固定的。电量快充满的时候会自动切换成恒压充电，此时电流是逐渐变小的，知道电流递减为 0 即便是充满。所以最后 10% 电量的充电时间会明显长于前面。 

## 参考文献

[锂电池电量监测原理](https://mp.weixin.qq.com/s/Kvuz7ccwmjCr3SBMVoNdaQ)
