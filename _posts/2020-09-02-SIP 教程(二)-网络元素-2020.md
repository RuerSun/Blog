---
layout:     post
title:      "SIP 教程(二) 网络元素, 2020"
subtitle:   "SIP"
date:       2020-09-02 08:54:00
author:     "Ruer"
header-img: "img/bg/hello_world.jpg"
catalog: true
tags:
    - SIP
---

有一些实体帮助 SIP 创建其网络。在 SIP 中，每个网络元件由类似地址的 SIP URI (统一资源标识符)标识。以下是网络元素：

* 用户代理
* 代理服务器
* 注册服务器
* 重定向服务器
* 位置服务器

## 用户代理

它是端点和 SIP 网络的最重要的网络元件之一。端点可以启动、修改或终止会话。 用户代理是 SIP 网络中最智能的设备或网络元件。它可以是软电话、移动电话或笔记本电脑。

用户代理在逻辑上分为两个部分：

* 用户代理客户端(UAC) - 发送请求并接收响应的实体。
* 用户代理服务器(UAS) - 接收请求并发送响应的实体。

SIP 基于客户端 - 服务器架构，其中呼叫者的电话充当发起呼叫的客户端，并且被叫者的电话充当响应呼叫的服务器。

## 代理服务器

它是从用户代理接收请求并将其转发给另一个用户的网络元素。

* 基本上代理服务器的作用就像一个路由器。
* 它具有一些智能来理解 SIP 请求并且在 URI 的帮助下向前发送它。
* 代理服务器位于两个用户代理之间。
* 源和目标之间最多可以有70个代理服务器。

有两种类型的代理服务器：

* 无状态代理服务器 - 它仅转发接收的消息。这种类型的服务器不存储呼叫或事务的任何信息。
* 状态代理服务器 - 此类型的代理服务器会跟踪收到的每个请求和响应，如果需要，将来可以使用它。如果没有来自另一方的响应，它可以重传请求。

## 注册服务器

注册服务器接受来自用户代理的注册请求。它帮助用户在网络中验证自己。它将 URI 和用户的位置存储在数据库中，以帮助同一域中的其他 SIP 服务器。

请看下面的示例，显示 SIP 注册的过程。

![1](/img/SIP/SIP注册过程.jpg)

这里呼叫者想要注册到 TMC 域。因此它向 TMC 的注册服务器发送注册请求，并且服务器在授权客户端时返回 200 OK 响应。

## 重定向服务器

重定向服务器接收请求并在由注册器创建的位置数据库中查找请求的预期接收者。

重定向服务器使用数据库获取位置信息，并以3xx(重定向响应)向用户作出响应。我们将在本教程的后面讨论响应代码。

## 位置服务器

位置服务器向重定向和代理服务器提供关于呼叫者可能的位置的信息。

只有代理服务器或重定向服务器可以联系位置服务器。

下图描述了每个网络元素在建立会话时所扮演的角色。

![2](/img/SIP/服务器角色扮演.jpg)